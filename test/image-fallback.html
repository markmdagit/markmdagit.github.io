<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Image fallback test</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 2rem; }
    .profile-image, .profile-fallback { width: 120px; height: 120px; border-radius: 50%; }
  </style>
</head>
<body>
  <h1>Profile Image Fallback Test</h1>
  <picture>
    <source id="test-source" type="image/webp" srcset="/images/profile/headshot-400.webp 400w">
    <img id="test-img" src="/images/profile/headshot.png" class="profile-image" alt="Profile">
  </picture>
  <svg id="test-fallback" class="profile-fallback" xmlns="http://www.w3.org/2000/svg" width="120" height="120" viewBox="0 0 120 120" role="img" aria-label="Profile placeholder" style="display:none;">
    <rect width="100%" height="100%" fill="#d8e3f0" rx="60" />
    <g transform="translate(20,24)" fill="#557">
      <circle cx="40" cy="16" r="16" />
      <path d="M0 72c0-22 80-22 80 0v4H0v-4z" />
    </g>
  </svg>

  <div style="margin-top:1rem">
    <button id="break">Force broken image</button>
    <button id="restore">Restore image</button>
  </div>

  <script>
    const img = document.getElementById('test-img');
    const fallback = document.getElementById('test-fallback');
    img.addEventListener('error', () => {
      img.style.display = 'none';
      fallback.style.display = 'block';
    });
    document.getElementById('break').addEventListener('click', () => {
      img.src = '/images/profile/nonexistent.png';
    });
    document.getElementById('restore').addEventListener('click', () => {
      img.src = '/images/profile/headshot.png';
      img.style.display = 'block';
      fallback.style.display = 'none';
    });
  </script>
</body>
</html>
